/**
 * @file Firestore Security Rules
 * @description This ruleset allows unauthenticated users to read the 'alunos' collection.
 *  Authenticated users can create, update, and delete 'alunos' documents.
 *
 * Data Structure:
 *   - /alunos/{alunoId}: Stores data for individual alunos. The document ID is the aluno's RM.
 *
 * Key Security Decisions:
 *   - The rules do not currently implement any role-based access control or owner-based access control.
 *   - The Aluno documents can be read by anyone including unauthenticated users.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows read access to all Aluno documents for any user.
     * @path /alunos/{alunoId}
     * @allow (get, list) Any user can read any aluno document.
     * @deny (create, update, delete) Only authenticated users can modify aluno documents.
     * @principle Allows public read access to the 'alunos' collection.
     */
    match /alunos/{alunoId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

  }

  function isSignedIn() {
    return request.auth != null;
  }
}
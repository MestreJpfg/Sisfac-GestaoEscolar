rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Rules for the 'students' collection
    match /students/{studentId} {
      // Allow read and write access to any authenticated user (including anonymous).
      // This is necessary for the main functionalities of the app, like uploading,
      // viewing, editing, and deleting student data.
      allow read, write: if request.auth != null;
    }

    // Rules for the 'users' collection
    match /users/{userId} {
      // Allow a user to read and write only their own document.
      // This is important for security, for example, to store FCM tokens
      // or other user-specific data.
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Default rule: Deny all other access to prevent unauthorized operations.
    // This is implicitly covered by not having other rules, but it's good practice
    // to remember that access is denied by default.
  }
}
